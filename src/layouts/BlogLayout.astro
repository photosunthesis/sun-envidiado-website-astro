---
import BaseLayout from "./BaseLayout.astro";

const backUrlLabel = ":back<Enter>";
const homeUrlLabel = ":home<Enter>";
const { frontmatter = {}, ...restProps } = Astro.props || {};

// Extract common SEO fields from frontmatter
const {
  title = "Blog",
  description = "",
  pubDate = undefined,
  tags = [],
  ...otherFrontmatter
} = frontmatter;

// Pass all remaining props except frontmatter fields
const rest = { ...restProps };
delete rest.title;
delete rest.description;
delete rest.pubDate;
delete rest.tags;
delete rest.frontmatter;

// --- Canonical/OG URL logic ---
const canonical = new URL(
  String(Astro.url?.pathname || "/").replace(/\/?$/, "/"),
  Astro.site || "https://sun-envidiado.com",
).toString();
---

<BaseLayout
  title={title}
  description={description}
  url={canonical}
  pubDate={pubDate}
  tags={tags}
  {...otherFrontmatter}
  {...rest}
>
  <div class="blog-layout">
    {
      pubDate ? (
        <article class="blog-article" aria-labelledby="post-title">
          <slot />
        </article>
      ) : (
        <slot />
      )
    }
    <footer
      class="blog-footer"
      role="contentinfo"
      aria-label="Post navigation and actions"
    >
      <p class="blog-footer-text">
        Tap or type
        <a href="#" onclick="history.back(); return false;" aria-label="Go back"
          >{backUrlLabel}</a
        >
        or
        <a href="/" aria-label="Go to homepage">{homeUrlLabel}</a>
        to go back or return to the homepage.
      </p>
    </footer>
  </div>
</BaseLayout>
