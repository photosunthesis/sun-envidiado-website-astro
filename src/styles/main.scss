@use 'sass:color' as color;

@font-face {
  font-family: 'ToshibaSat8x14';
  src:
    url('/fonts/Web437_ToshibaSat_8x14.woff2') format('woff2'),
    url('/fonts/Web437_ToshibaSat_8x14.woff') format('woff');
  font-display: swap;
  font-weight: normal;
  font-style: normal;
}

:root {
  --background: #09090b;
  --background-rgb: 9, 9, 11;
  --foreground: #abb2bf;
  --foreground-rgb: 171, 178, 191;
  --comment: rgba(171, 178, 191, 0.5);
  --cyan: #56b6c2;
  --cyan-rgb: 86, 182, 194;
  --green: #98c379;
  --orange: #d19a66;
  --pink: #c678dd;
  --purple: #a9a1e1;
  --red: #e06c75;
  --yellow: #e5c07b;
  --blue: #61afef;

  --code-bg: rgba(31, 35, 40, 0.3);
  --code-fg: #dcdfe4;
}

html,
body {
  margin: 0;
  padding: 0;
  background: var(--background);
  color: var(--foreground);
  font-family: 'ToshibaSat8x14', 'Menlo', 'Monaco', 'Consolas', 'Courier New', monospace;
  min-height: 100vh;
}

* {
  box-sizing: border-box;
  font-size: 1.069rem;

  @media (max-width: 480px) {
    font-size: 1rem;
  }
}

a,
button {
  color: var(--cyan);
  font-family: inherit;
  text-decoration: none;
  background: none;
  border: none;
  cursor: pointer;
}

a:hover,
a:focus,
button.link-like:hover,
button.link-like:focus {
  color: var(--cyan);
  text-decoration: underline;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  line-height: 1.6;
  text-align: left;
  color: var(--cyan);
}

h1 {
  font-size: 1.5rem;
}

h2,
h3 {
  font-size: 1.3rem;
}

h4 {
  font-size: 1.1rem;
}

h5 {
  font-size: 1rem;
}

h6 {
  font-size: 0.8rem;
}

p {
  text-align: left;
  line-height: 1.6;
}

pre {
  color: var(--code-fg);
  border-radius: 8px;
  overflow: auto;
  line-height: 1.5;
  margin: 1rem 0;
  white-space: pre-wrap;
  word-break: break-word;
}

code {
  padding: 0;
  border-radius: 4px;
}

ul,
ol {
  margin-left: 1.1rem;
  padding-left: 1rem;
  margin-bottom: 1rem;
}

li {
  margin: 0.45rem 0;
  line-height: 1.4;
}

pre[class*='astro-code'] {
  background-color: rgba(var(--foreground-rgb), 0.069) !important;
  color: inherit !important;
  overflow-x: visible !important;
  padding: 0.8rem;
  line-height: 1.2;
  border-radius: 0;

  span {
    font-size: 0.8rem !important;
  }
}

.back-to-home {
  padding-bottom: 1rem;

  a,
  button {
    color: var(--comment);
    padding: 0;

    &:hover {
      color: var(--cyan);
      text-decoration: underline;
    }
  }
}

.skip-link {
  position: absolute;
  left: -999px;
  top: auto;
  width: 1px;
  height: 1px;
  overflow: hidden;
  z-index: -999;
}

.skip-link:focus {
  position: fixed;
  left: 1rem;
  top: 1rem;
  width: auto;
  height: auto;
  padding: 0.5rem 1rem;
  background: #111;
  color: #fff;
  z-index: 1000;
}

/* Accessible utility: visually-hidden but available to screen readers */
.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0 0 0 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

.content-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  text-align: center;
  position: relative;
  z-index: 1;
}

.sr-only {
  position: absolute !important;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

$crt-stripe-width: 3px;
$crt-stripe-opacity: 0.12;
$crt-scan-opacity: 0.7;
$crt-vignette-opacity: 0.6;
$crt-ca-blur: 0.35px;
$crt-red: rgb(218, 49, 49);
$crt-green: rgb(112, 159, 115);
$crt-blue: rgb(40, 129, 206);

#crt-overlay-container {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  filter: contrast(1) saturate(2) hue-rotate(6deg);

  &::before,
  &::after {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 99999;
    display: block;
  }

  &::before {
    mix-blend-mode: screen;
    opacity: 0.8;
    transform: translate3d(2px, 0, 0);
    filter: blur($crt-ca-blur);
    background-image:
      linear-gradient(rgba(8, 8, 8, 0.16), rgba(8, 8, 8, 0.16)),
      repeating-linear-gradient(
        to right,
        rgba($crt-red, $crt-stripe-opacity) 0,
        rgba($crt-green, $crt-stripe-opacity) $crt-stripe-width,
        rgba($crt-blue, $crt-stripe-opacity) calc($crt-stripe-width * 2)
      );

    @media (max-width: 480px) {
      background-image:
        linear-gradient(
          to bottom,
          rgba(0, 0, 0, 0.98) 0%,
          rgba(0, 0, 0, 0.92) 18%,
          rgba(0, 0, 0, 0.7) 38%,
          rgba(0, 0, 0, 0.25) 60%,
          rgba(0, 0, 0, 0) 100%
        ),
        linear-gradient(rgba(8, 8, 8, 0.16), rgba(8, 8, 8, 0.16)),
        repeating-linear-gradient(
          to right,
          rgba($crt-red, $crt-stripe-opacity) 0,
          rgba($crt-green, $crt-stripe-opacity) $crt-stripe-width,
          rgba($crt-blue, $crt-stripe-opacity) calc($crt-stripe-width * 2)
        );
      background-repeat: no-repeat, repeat, repeat;
      background-size:
        100% calc(env(safe-area-inset-top, 64px) + 64px),
        auto,
        auto;
    }
  }

  &::after {
    mix-blend-mode: multiply;
    opacity: calc(0.6 + ($crt-vignette-opacity * 0.4));
    transform: translate3d(-2px, 0, 0);
    filter: blur(calc($crt-ca-blur * 1.2));
    background-image:
      radial-gradient(
        ellipse at center,
        transparent 30%,
        rgba(0, 0, 0, calc($crt-vignette-opacity * 0.72)) 70%
      ),
      repeating-linear-gradient(
        90deg,
        rgba($crt-red, $crt-stripe-opacity) 1px,
        rgba($crt-green, $crt-stripe-opacity) 2px,
        rgba($crt-blue, $crt-stripe-opacity) 3px
      ),
      repeating-linear-gradient(
        to bottom,
        rgba(0, 0, 0, $crt-scan-opacity) 0,
        rgba(0, 0, 0, $crt-scan-opacity) 1px,
        transparent 1px,
        transparent 3px
      );
    box-shadow: inset 0 0 360px rgba(0, 0, 0, $crt-vignette-opacity);
  }
}

$rgb-offset: 2px;

/* Apply chromatic fringe on fonts site-wide */
body .content-wrapper,
body .content-wrapper * {
  -webkit-font-smoothing: antialiased;
  text-shadow:
    $rgb-offset 0 $crt-ca-blur rgba($crt-red, 0.14),
    -$rgb-offset 0 $crt-ca-blur rgba($crt-green, 0.26),
    0 $rgb-offset $crt-ca-blur rgba($crt-blue, 0.26),
    0 0 0.35px rgba(0, 0, 0, 0.1);
  filter: contrast(1.02);

  @media (max-width: 480px) {
    $mobile-rgb-offset: 1px;

    text-shadow:
      $mobile-rgb-offset 0 $crt-ca-blur rgba($crt-red, 0.14),
      -$mobile-rgb-offset 0 $crt-ca-blur rgba($crt-green, 0.26),
      0 $mobile-rgb-offset $crt-ca-blur rgba($crt-blue, 0.26),
      0 0 0.35px rgba(0, 0, 0, 0.1);
  }
}

.hide-on-mobile {
  display: block;

  @media (max-width: 480px) {
    display: none !important;
  }
}
